{"version":"NotebookV1","origId":2747100633752068,"name":"11_Spark_DataFrame_JSON _Processing","language":"python","commands":[{"version":"CommandV1","origId":2747100633752069,"guid":"fed88431-f571-472c-89b0-15b6b18df8a7","subtype":"command","commandType":"auto","position":1.0,"command":"","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"92ee727e-b09e-4b34-a705-8af72274c0f8"},{"version":"CommandV1","origId":2747100633752070,"guid":"62c846eb-59d5-484b-99a0-17cc0f43d4ec","subtype":"command","commandType":"auto","position":2.0,"command":"dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_0.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/assignment.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_2.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_1.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_4.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_3.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_5.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_6.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_7.json\ndbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_corrupted.json","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"46ed5dfe-d424-4199-a95e-f925cd758581"},{"version":"CommandV1","origId":2747100633752071,"guid":"42382cbc-8b7b-4714-bffd-908473277a55","subtype":"command","commandType":"auto","position":3.0,"command":"emp_details_0.json\n\n{\"id\":101,\"name\":\"srinivas\",\"gender\":\"male\",\"language\":\"english\",\"location\":\"hyderabad\"}","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3b287f3b-14a2-4aa6-8453-573f9518e948"},{"version":"CommandV1","origId":2747100633752072,"guid":"b8df8160-c53f-4331-9a27-cff292f692d0","subtype":"command","commandType":"auto","position":4.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_0.json'\n\ndf1 = spark.read.format(\"json\").load(filepath)\n\ndf1.show()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+------+---+--------+---------+--------+\n|gender| id|language| location|    name|\n+------+---+--------+---------+--------+\n|  male|101| english|hyderabad|srinivas|\n+------+---+--------+---------+--------+\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"language","nullable":true,"type":"string"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714543997889,"submitTime":1714543997837,"finishTime":1714543999979,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",206]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"09c34f25-93e8-4f49-9e81-82200e71d16d"},{"version":"CommandV1","origId":2747100633752073,"guid":"a5b8fd82-3ea2-420d-9c30-553633715dd1","subtype":"command","commandType":"auto","position":5.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_1.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndf1.show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+------+---+--------+---------+--------+\n|gender| id|language| location|    name|\n+------+---+--------+---------+--------+\n|  male|  1| english|hyderabad|srinivas|\n+------+---+--------+---------+--------+\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"language","nullable":true,"type":"string"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544071872,"submitTime":1714544071863,"finishTime":1714544073454,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",206]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b9542e4f-00b9-434d-b886-76cde0e38c79"},{"version":"CommandV1","origId":2747100633752074,"guid":"c3250513-e2b7-4901-b9c2-d7451af87321","subtype":"command","commandType":"auto","position":4.5,"command":"emp_details_1.json\n------------------\n{\n\"id\":\"1\",\n\"name\":\"srinivas\",\n\"gender\":\"male\",\n\"language\":\"english\",\n\"location\":\"hyderabad\"\n}","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5f8fd376-1b7b-4096-aa9f-2d01200d53fc"},{"version":"CommandV1","origId":2747100633752075,"guid":"7c07cab9-3837-4b8f-b544-e94b9adb39e8","subtype":"command","commandType":"auto","position":6.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_2.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndf1.show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+------+---+--------+\n|gender| id|    name|\n+------+---+--------+\n|  male|101|srinivas|\n|  male|102|   phani|\n+------+---+--------+\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544123659,"submitTime":1714544123649,"finishTime":1714544124904,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",133]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ed8d5c60-a66d-4d2f-9266-50c451f668c8"},{"version":"CommandV1","origId":2747100633752076,"guid":"2905ca17-e6f6-4130-8747-1d94b2397446","subtype":"command","commandType":"auto","position":5.5,"command":"emp_details_2.json\n-----------------\n[\n{\n\"id\":\"101\",\n\"name\":\"srinivas\",\n\"gender\":\"male\"\n},\n{\n\"id\":\"102\",\n\"name\":\"phani\",\n\"gender\":\"male\"\n}\n]","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ed8e6d4d-9f73-4a04-a41d-93259774b582"},{"version":"CommandV1","origId":2747100633752077,"guid":"d1a9dc5d-e71c-4e25-8637-8c5aaa811ade","subtype":"command","commandType":"auto","position":7.0,"command":"emp_details_3.json\n-------------------\n[\n{\n\"id\":\"101\",\n\"name\":\"srinivas\",\n\"gender\":\"male\",\n\"phonenumber\":9999\n},\n{\n\"id\":\"102\",\n\"name\":\"phani\",\n\"gender\":\"male\",\n\"location\":\"Hyderabad\"\n}\n]","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4488d922-9d25-40f3-a39c-3225428ce0f6"},{"version":"CommandV1","origId":2747100633752078,"guid":"5a745a8e-19f3-4b9c-b8dc-5122d5e636fd","subtype":"command","commandType":"auto","position":8.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_3.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndf1.show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+------+---+---------+--------+-----------+\n|gender| id| location|    name|phonenumber|\n+------+---+---------+--------+-----------+\n|  male|101|     null|srinivas|       9999|\n|  male|102|Hyderabad|   phani|       null|\n+------+---+---------+--------+-----------+\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"location","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"phonenumber","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544185385,"submitTime":1714544185375,"finishTime":1714544186556,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",265]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"242804e9-98a1-45f5-926e-86dc87d434c6"},{"version":"CommandV1","origId":2747100633752079,"guid":"ab5e52df-c066-423a-9188-e7a556cfc284","subtype":"command","commandType":"auto","position":9.0,"command":"emp_details_4.json \n---------------------\n[\n{\n\"id\":\"101\",\n\"name\":\"srinivas\",\n\"gender\":\"male\",\n\"address\":{\n            \"city\":\"Hyderabad\",\n\t\t\t\"country\":\"india\"\n          } \n},\n{\n\"id\":\"102\",\n\"name\":\"phani\",\n\"gender\":\"male\",\n\"address\":{\n            \"city\":\"Hyderabad\",\n\t\t\t\"country\":\"india\"\n          }\n}\n]","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"02f8e372-d3d1-402d-9a52-b52f47978249"},{"version":"CommandV1","origId":2747100633752080,"guid":"38b57d5f-8b6e-4630-9dc7-73b6af87496a","subtype":"command","commandType":"auto","position":10.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_4.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndf1 = df1.select(\"id\",\"name\",\"gender\",\"address.city\",\"address.country\")\n\ndf1.show()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+---+--------+------+---------+-------+\n| id|    name|gender|     city|country|\n+---+--------+------+---------+-------+\n|101|srinivas|  male|Hyderabad|  india|\n|102|   phani|  male|Hyderabad|  india|\n+---+--------+------+---------+-------+\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"country","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544307334,"submitTime":1714544307307,"finishTime":1714544308823,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",241]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"fdab135d-0b1b-4514-883d-82605a5337a9"},{"version":"CommandV1","origId":2747100633752081,"guid":"2dc41a8c-7824-4631-a19b-77f846aa220e","subtype":"command","commandType":"auto","position":11.0,"command":"emp_details_5.json\n----------------------\n[\n{\n\"id\":\"101\",\n\"name\":\"srinivas\",\n\"gender\":\"male\",\n\"address\":{\n            \"city\":\"Hyderabad\",\n\t\t\t\"country\":\"india\",\n\t\t\t\"house_dtls\":{\n\t\t\t                \"doorno\":\"1-2-3\",\n\t\t\t\t\t\t\t\"street\":\"srnagar\"\n\t\t\t             }\n          } \n},\n{\n\"id\":\"102\",\n\"name\":\"phani\",\n\"gender\":\"male\",\n\"address\":{\n            \"city\":\"Hyderabad\",\n\t\t\t\"country\":\"india\",\n\t\t\t\"house_dtls\":{\n\t\t\t                \"doorno\":\"1-2-3\",\n\t\t\t\t\t\t\t\"street\":\"ameerpet\"\n\t\t\t             }\n          }\n}\n]","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6db88fe8-f768-4b93-aafa-cabc6029d158"},{"version":"CommandV1","origId":2747100633752082,"guid":"efeb1f9b-71c8-4bfd-bc68-aea7dbd148d6","subtype":"command","commandType":"auto","position":12.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_5.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndf1 = df1.select(\"id\",\"name\",\"gender\",\"address.city\",\"address.country\",\"address.house_dtls.doorno\",\"address.house_dtls.street\")\n\ndisplay(df1)","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["101","srinivas","male","Hyderabad","india","1-2-3","srnagar"],["102","phani","male","Hyderabad","india","1-2-3","ameerpet"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"gender","type":"\"string\"","metadata":"{}"},{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"country","type":"\"string\"","metadata":"{}"},{"name":"doorno","type":"\"string\"","metadata":"{}"},{"name":"street","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"country","nullable":true,"type":"string"},{"metadata":{},"name":"doorno","nullable":true,"type":"string"},{"metadata":{},"name":"street","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544532032,"submitTime":1714544532020,"finishTime":1714544533417,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",2]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"39519d87-d31a-45d9-b0c7-32389ca7a98c"},{"version":"CommandV1","origId":2747100633752083,"guid":"fbb12dfd-e173-4d49-985a-246c1978bb02","subtype":"command","commandType":"auto","position":13.0,"command":"df1.write.format(\"json\").mode(\"overwrite\").save(\"dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/person_dtls\")","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544591841,"submitTime":1714544591831,"finishTime":1714544594190,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"27999352-736e-44f9-b28c-07f428b431d6"},{"version":"CommandV1","origId":2747100633752084,"guid":"71b0d9bf-432a-4037-81ba-2d8373838e3b","subtype":"command","commandType":"auto","position":14.0,"command":"dbutils.fs.ls('dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/person_dtls')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"Out[13]: [FileInfo(path='dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/person_dtls/_SUCCESS', name='_SUCCESS', size=0, modificationTime=1714544594000),\n FileInfo(path='dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/person_dtls/_committed_340613866137619431', name='_committed_340613866137619431', size=113, modificationTime=1714544594000),\n FileInfo(path='dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/person_dtls/_started_340613866137619431', name='_started_340613866137619431', size=0, modificationTime=1714544593000),\n FileInfo(path='dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/person_dtls/part-00000-tid-340613866137619431-267736da-dfdf-45fc-abac-78457d915c33-146-1-c000.json', name='part-00000-tid-340613866137619431-267736da-dfdf-45fc-abac-78457d915c33-146-1-c000.json', size=238, modificationTime=1714544594000)]","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544610838,"submitTime":1714544610816,"finishTime":1714544611006,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",868]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6fd687cd-5fca-4d6e-9050-26adb9459aa5"},{"version":"CommandV1","origId":2747100633752085,"guid":"24c81417-61f2-423f-908a-cc05d35d0557","subtype":"command","commandType":"auto","position":15.0,"command":"%sql \ncreate table prsn_dtls_j\nusing json \nlocation 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/person_dtls'","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544647652,"submitTime":1714544647641,"finishTime":1714544651251,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"44c7ea05-d2f0-49ae-a3aa-de78f1afb63c"},{"version":"CommandV1","origId":2747100633752086,"guid":"0b550605-1f55-4758-b399-760fe7b96f5b","subtype":"command","commandType":"auto","position":16.0,"command":"%sql \nselect * from prsn_dtls_j","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["Hyderabad","india","1-2-3","male","101","srinivas","srnagar"],["Hyderabad","india","1-2-3","male","102","phani","ameerpet"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"city","type":"\"string\"","metadata":"{}"},{"name":"country","type":"\"string\"","metadata":"{}"},{"name":"doorno","type":"\"string\"","metadata":"{}"},{"name":"gender","type":"\"string\"","metadata":"{}"},{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"street","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"city","nullable":true,"type":"string"},{"metadata":{},"name":"country","nullable":true,"type":"string"},{"metadata":{},"name":"doorno","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"street","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544661971,"submitTime":1714544661957,"finishTime":1714544663065,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",2]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"47b82a26-0f6d-4956-962c-5b75805e1617"},{"version":"CommandV1","origId":2747100633752087,"guid":"213c5c4b-b3b9-469b-b57d-d037ae2d4c38","subtype":"command","commandType":"auto","position":17.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_6.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndf1 = df1.select(\"id\",\"name\",\"gender\",df1.languages[0])\n\ndisplay(df1)\n","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["101","srinivas","male","English"],["102","phani","male","English"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"gender","type":"\"string\"","metadata":"{}"},{"name":"languages[0]","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"languages[0]","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544836671,"submitTime":1714544836662,"finishTime":1714544837748,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",2]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f9aff589-25bd-4725-adb2-8f68a3b2266d"},{"version":"CommandV1","origId":2747100633752088,"guid":"897e13bf-9743-4905-8c2e-5eb138747885","subtype":"command","commandType":"auto","position":16.5,"command":"emp_details_6.json\n------------------\n[\n{\n\"id\":\"101\",\n\"name\":\"srinivas\",\n\"gender\":\"male\",\n\"languages\":[\"English\",\"Hindi\"]\n},\n{\n\"id\":\"102\",\n\"name\":\"phani\",\n\"gender\":\"male\",\n\"languages\":[\"English\",\"Hindi\"]\n}\n]\n","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f2a2cbf2-0f8b-4d9f-b181-f7c46187590f"},{"version":"CommandV1","origId":2747100633752089,"guid":"3ed5d608-9a56-4a51-8ef3-4d6f525cc824","subtype":"command","commandType":"auto","position":18.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_6.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndisplay(df1)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["male","101",["English","Hindi"],"srinivas"],["male","102",["English","Hindi"],"phani"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"gender","type":"\"string\"","metadata":"{}"},{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"languages","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"languages","nullable":true,"type":{"containsNull":true,"elementType":"string","type":"array"}},{"metadata":{},"name":"name","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544857502,"submitTime":1714544857493,"finishTime":1714544858479,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",2]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ebf7acb3-9d64-40db-b66a-b735720839ad"},{"version":"CommandV1","origId":2747100633752090,"guid":"aa257331-68e3-4e58-b061-74cb91c1f1b7","subtype":"command","commandType":"auto","position":19.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_6.json'\n\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\n\ndf1 = df1.select(\"id\",\"name\",\"gender\",explode(\"languages\").alias(\"lang\"))","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"lang","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544974183,"submitTime":1714544974172,"finishTime":1714544975123,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"88bb5d43-1da2-46df-b17a-35735d05a8f9"},{"version":"CommandV1","origId":2747100633752091,"guid":"eb3febe7-4cad-4ac1-9cbd-31692a9419aa","subtype":"command","commandType":"auto","position":18.5,"command":"from pyspark.sql.functions import explode","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544927015,"submitTime":1714544927004,"finishTime":1714544927080,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"4aa1c0fc-e250-4f43-bad4-a0030755bf67"},{"version":"CommandV1","origId":2747100633752092,"guid":"8eeebf06-7dd3-46ef-af95-e8d196058fe6","subtype":"command","commandType":"auto","position":20.0,"command":"df1.show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"+---+--------+------+-------+\n| id|    name|gender|   lang|\n+---+--------+------+-------+\n|101|srinivas|  male|English|\n|101|srinivas|  male|  Hindi|\n|102|   phani|  male|English|\n|102|   phani|  male|  Hindi|\n+---+--------+------+-------+\n\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714544979213,"submitTime":1714544979202,"finishTime":1714544979527,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",241]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e760c420-32f8-4e88-8ee0-b6eeed3364a0"},{"version":"CommandV1","origId":2747100633752093,"guid":"86dfe527-41bc-41f1-9b9d-dc551d7b35db","subtype":"command","commandType":"auto","position":21.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_7.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndf1 = df1.select(\"id\",\"name\",\"gender\",explode(\"languages\").alias(\"lang\"),df1.address.city , df1.address.country)\n\ndisplay(df1)","commandVersion":13,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["101","srinivas","male","English","Hyderabad","india"],["101","srinivas","male","Hindi","Hyderabad","india"],["102","phani","male","English","Hyderabad","india"],["102","phani","male","Hindi","Hyderabad","india"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"gender","type":"\"string\"","metadata":"{}"},{"name":"lang","type":"\"string\"","metadata":"{}"},{"name":"address.city","type":"\"string\"","metadata":"{}"},{"name":"address.country","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df1","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"lang","nullable":true,"type":"string"},{"metadata":{},"name":"address.city","nullable":true,"type":"string"},{"metadata":{},"name":"address.country","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714545147447,"submitTime":1714545147437,"finishTime":1714545148796,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",4]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7dc8edf9-2cc6-4944-8c79-5d3361c21c65"},{"version":"CommandV1","origId":2747100633752094,"guid":"2c289594-b709-4ac6-9dc3-be421cafe952","subtype":"command","commandType":"auto","position":20.5,"command":"emp_details_7.json\n---------------------\n\n[\n{\n\"id\":\"101\",\n\"name\":\"srinivas\",\n\"gender\":\"male\",\n\"languages\":[\"English\",\"Hindi\"],\n\"address\":{\n            \"city\":\"Hyderabad\",\n\t\t\t\"country\":\"india\"\n          } \n},\n{\n\"id\":\"102\",\n\"name\":\"phani\",\n\"gender\":\"male\",\n\"languages\":[\"English\",\"Hindi\"],\n\"address\":{\n            \"city\":\"Hyderabad\",\n\t\t\t\"country\":\"india\"\n          }\n}\n]\n\n","commandVersion":2,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"c1a8c775-9021-422c-b53d-a81370924712"},{"version":"CommandV1","origId":2747100633752095,"guid":"de2ad514-0c69-4a5c-a168-eb84085016b3","subtype":"command","commandType":"auto","position":22.0,"command":"df1.write.format(\"json\").mode(\"overwrite\").saveAsTable(\"emp_dtls_json_tbl\")","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714545220736,"submitTime":1714545220712,"finishTime":1714545222667,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"44fbaa3e-0ab9-4317-a8a6-589ca11a66bb"},{"version":"CommandV1","origId":2747100633752096,"guid":"5804b4c1-d52e-442f-8bd8-96d0b3538ded","subtype":"command","commandType":"auto","position":23.0,"command":"%sql\n\nselect * from emp_dtls_json_tbl","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["101","srinivas","male","English","Hyderabad","india"],["101","srinivas","male","Hindi","Hyderabad","india"],["102","phani","male","English","Hyderabad","india"],["102","phani","male","Hindi","Hyderabad","india"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"gender","type":"\"string\"","metadata":"{}"},{"name":"lang","type":"\"string\"","metadata":"{}"},{"name":"address.city","type":"\"string\"","metadata":"{}"},{"name":"address.country","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"string"},{"metadata":{},"name":"name","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"lang","nullable":true,"type":"string"},{"metadata":{},"name":"address.city","nullable":true,"type":"string"},{"metadata":{},"name":"address.country","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714545231744,"submitTime":1714545231734,"finishTime":1714545232784,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",4]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"32d3249c-716e-4e8d-a03d-f5082c4737ef"},{"version":"CommandV1","origId":2747100633752097,"guid":"b90a2eec-6f97-4b37-b9dc-d3c8c8b2e05a","subtype":"command","commandType":"auto","position":22.5,"command":"%sql \n\ndesc formatted emp_dtls_json_tbl","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["id","string",null],["name","string",null],["gender","string",null],["lang","string",null],["address.city","string",null],["address.country","string",null],["","",""],["# Detailed Table Information","",""],["Catalog","spark_catalog",""],["Database","default",""],["Table","emp_dtls_json_tbl",""],["Owner","root",""],["Created Time","Wed May 01 06:33:42 UTC 2024",""],["Last Access","UNKNOWN",""],["Created By","Spark 3.3.2",""],["Type","MANAGED",""],["Provider","json",""],["Statistics","571 bytes",""],["Location","dbfs:/user/hive/warehouse/emp_dtls_json_tbl",""],["Serde Library","org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe",""],["InputFormat","org.apache.hadoop.mapred.SequenceFileInputFormat",""],["OutputFormat","org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat",""]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"col_name","type":"\"string\"","metadata":"{\"comment\":\"name of the column\"}"},{"name":"data_type","type":"\"string\"","metadata":"{\"comment\":\"data type of the column\"}"},{"name":"comment","type":"\"string\"","metadata":"{\"comment\":\"comment of the column\"}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{"comment":"name of the column"},"name":"col_name","nullable":false,"type":"string"},{"metadata":{"comment":"data type of the column"},"name":"data_type","nullable":false,"type":"string"},{"metadata":{"comment":"comment of the column"},"name":"comment","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714545277528,"submitTime":1714545277517,"finishTime":1714545277823,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",22]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"6654706d-fcf7-41ec-bd74-48ba3137930a"},{"version":"CommandV1","origId":2747100633752098,"guid":"e8eaa25a-12b2-46fe-9eb0-5c389f1eca73","subtype":"command","commandType":"auto","position":24.0,"command":"dbutils.fs.ls('dbfs:/user/hive/warehouse/emp_dtls_json_tbl')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"Out[35]: [FileInfo(path='dbfs:/user/hive/warehouse/emp_dtls_json_tbl/_SUCCESS', name='_SUCCESS', size=0, modificationTime=1714545222000),\n FileInfo(path='dbfs:/user/hive/warehouse/emp_dtls_json_tbl/_committed_269591883151698994', name='_committed_269591883151698994', size=113, modificationTime=1714545222000),\n FileInfo(path='dbfs:/user/hive/warehouse/emp_dtls_json_tbl/_started_269591883151698994', name='_started_269591883151698994', size=0, modificationTime=1714545222000),\n FileInfo(path='dbfs:/user/hive/warehouse/emp_dtls_json_tbl/part-00000-tid-269591883151698994-3c8bbbde-d367-41e6-9270-3dc3cb9b2008-165-1-c000.json', name='part-00000-tid-269591883151698994-3c8bbbde-d367-41e6-9270-3dc3cb9b2008-165-1-c000.json', size=458, modificationTime=1714545222000)]","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714545305444,"submitTime":1714545305435,"finishTime":1714545305649,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",764]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"db68cdba-bfd4-450b-80ae-2a909ffa59c7"},{"version":"CommandV1","origId":2747100633752099,"guid":"303f03af-a658-4761-a9eb-7935057da9a2","subtype":"command","commandType":"auto","position":25.0,"command":"emp_details_corrupted.json \n------------------------\n[\n{\n\"id\":\"101\",\n\"name\":\"srinivas\"\n\"gender\":\"male\"\n},\n{\n\"id\":\"102\",\n\"name\":\"phani\",\n\"gender\":\"male\"\n}\n]","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"944c0766-240f-4e43-a521-774765ab8fcc"},{"version":"CommandV1","origId":2747100633752100,"guid":"78b52b73-8510-4c0d-9c36-9878d127e715","subtype":"command","commandType":"auto","position":26.0,"command":"filepath = 'dbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_corrupted.json'\n\ndf1 = spark.read.format(\"json\").option(\"multiline\",True).load(filepath)\n\ndf1.show()\n","commandVersion":4,"state":"error","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":"<span class='ansi-red-fg'>AnalysisException</span>: Since Spark 2.3, the queries from raw JSON/CSV files are disallowed when the\nreferenced columns only include the internal corrupt record column\n(named _corrupt_record by default). For example:\nspark.read.schema(schema).csv(file).filter($\"_corrupt_record\".isNotNull).count()\nand spark.read.schema(schema).csv(file).select(\"_corrupt_record\").show().\nInstead, you can cache or save the parsed results and then send the same query.\nFor example, val df = spark.read.schema(schema).csv(file).cache() and then\ndf.filter($\"_corrupt_record\".isNotNull).count().","errorTraceType":"ansi","error":"\u001B[0;31m---------------------------------------------------------------------------\u001B[0m\n\u001B[0;31mAnalysisException\u001B[0m                         Traceback (most recent call last)\nFile \u001B[0;32m<command-2747100633752100>:5\u001B[0m\n\u001B[1;32m      1\u001B[0m filepath \u001B[38;5;241m=\u001B[39m \u001B[38;5;124m'\u001B[39m\u001B[38;5;124mdbfs:/FileStore/shared_uploads/pvrcloudtech@gmail.com/AVD/srcfiles/emp_details_corrupted.json\u001B[39m\u001B[38;5;124m'\u001B[39m\n\u001B[1;32m      3\u001B[0m df1 \u001B[38;5;241m=\u001B[39m spark\u001B[38;5;241m.\u001B[39mread\u001B[38;5;241m.\u001B[39mformat(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mjson\u001B[39m\u001B[38;5;124m\"\u001B[39m)\u001B[38;5;241m.\u001B[39moption(\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mmultiline\u001B[39m\u001B[38;5;124m\"\u001B[39m,\u001B[38;5;28;01mTrue\u001B[39;00m)\u001B[38;5;241m.\u001B[39mload(filepath)\n\u001B[0;32m----> 5\u001B[0m df1\u001B[38;5;241m.\u001B[39mshow()\n\nFile \u001B[0;32m/databricks/spark/python/pyspark/instrumentation_utils.py:48\u001B[0m, in \u001B[0;36m_wrap_function.<locals>.wrapper\u001B[0;34m(*args, **kwargs)\u001B[0m\n\u001B[1;32m     46\u001B[0m start \u001B[38;5;241m=\u001B[39m time\u001B[38;5;241m.\u001B[39mperf_counter()\n\u001B[1;32m     47\u001B[0m \u001B[38;5;28;01mtry\u001B[39;00m:\n\u001B[0;32m---> 48\u001B[0m     res \u001B[38;5;241m=\u001B[39m \u001B[43mfunc\u001B[49m\u001B[43m(\u001B[49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[43margs\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[38;5;241;43m*\u001B[39;49m\u001B[43mkwargs\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m     49\u001B[0m     logger\u001B[38;5;241m.\u001B[39mlog_success(\n\u001B[1;32m     50\u001B[0m         module_name, class_name, function_name, time\u001B[38;5;241m.\u001B[39mperf_counter() \u001B[38;5;241m-\u001B[39m start, signature\n\u001B[1;32m     51\u001B[0m     )\n\u001B[1;32m     52\u001B[0m     \u001B[38;5;28;01mreturn\u001B[39;00m res\n\nFile \u001B[0;32m/databricks/spark/python/pyspark/sql/dataframe.py:920\u001B[0m, in \u001B[0;36mDataFrame.show\u001B[0;34m(self, n, truncate, vertical)\u001B[0m\n\u001B[1;32m    914\u001B[0m     \u001B[38;5;28;01mraise\u001B[39;00m PySparkTypeError(\n\u001B[1;32m    915\u001B[0m         error_class\u001B[38;5;241m=\u001B[39m\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mNOT_A_BOOLEAN\u001B[39m\u001B[38;5;124m\"\u001B[39m,\n\u001B[1;32m    916\u001B[0m         message_parameters\u001B[38;5;241m=\u001B[39m{\u001B[38;5;124m\"\u001B[39m\u001B[38;5;124marg_name\u001B[39m\u001B[38;5;124m\"\u001B[39m: \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124mvertical\u001B[39m\u001B[38;5;124m\"\u001B[39m, \u001B[38;5;124m\"\u001B[39m\u001B[38;5;124marg_type\u001B[39m\u001B[38;5;124m\"\u001B[39m: \u001B[38;5;28mtype\u001B[39m(vertical)\u001B[38;5;241m.\u001B[39m\u001B[38;5;18m__name__\u001B[39m},\n\u001B[1;32m    917\u001B[0m     )\n\u001B[1;32m    919\u001B[0m \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;28misinstance\u001B[39m(truncate, \u001B[38;5;28mbool\u001B[39m) \u001B[38;5;129;01mand\u001B[39;00m truncate:\n\u001B[0;32m--> 920\u001B[0m     \u001B[38;5;28mprint\u001B[39m(\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43m_jdf\u001B[49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mshowString\u001B[49m\u001B[43m(\u001B[49m\u001B[43mn\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;241;43m20\u001B[39;49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[43mvertical\u001B[49m\u001B[43m)\u001B[49m)\n\u001B[1;32m    921\u001B[0m \u001B[38;5;28;01melse\u001B[39;00m:\n\u001B[1;32m    922\u001B[0m     \u001B[38;5;28;01mtry\u001B[39;00m:\n\nFile \u001B[0;32m/databricks/spark/python/lib/py4j-0.10.9.5-src.zip/py4j/java_gateway.py:1321\u001B[0m, in \u001B[0;36mJavaMember.__call__\u001B[0;34m(self, *args)\u001B[0m\n\u001B[1;32m   1315\u001B[0m command \u001B[38;5;241m=\u001B[39m proto\u001B[38;5;241m.\u001B[39mCALL_COMMAND_NAME \u001B[38;5;241m+\u001B[39m\\\n\u001B[1;32m   1316\u001B[0m     \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mcommand_header \u001B[38;5;241m+\u001B[39m\\\n\u001B[1;32m   1317\u001B[0m     args_command \u001B[38;5;241m+\u001B[39m\\\n\u001B[1;32m   1318\u001B[0m     proto\u001B[38;5;241m.\u001B[39mEND_COMMAND_PART\n\u001B[1;32m   1320\u001B[0m answer \u001B[38;5;241m=\u001B[39m \u001B[38;5;28mself\u001B[39m\u001B[38;5;241m.\u001B[39mgateway_client\u001B[38;5;241m.\u001B[39msend_command(command)\n\u001B[0;32m-> 1321\u001B[0m return_value \u001B[38;5;241m=\u001B[39m \u001B[43mget_return_value\u001B[49m\u001B[43m(\u001B[49m\n\u001B[1;32m   1322\u001B[0m \u001B[43m    \u001B[49m\u001B[43manswer\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mgateway_client\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mtarget_id\u001B[49m\u001B[43m,\u001B[49m\u001B[43m \u001B[49m\u001B[38;5;28;43mself\u001B[39;49m\u001B[38;5;241;43m.\u001B[39;49m\u001B[43mname\u001B[49m\u001B[43m)\u001B[49m\n\u001B[1;32m   1324\u001B[0m \u001B[38;5;28;01mfor\u001B[39;00m temp_arg \u001B[38;5;129;01min\u001B[39;00m temp_args:\n\u001B[1;32m   1325\u001B[0m     temp_arg\u001B[38;5;241m.\u001B[39m_detach()\n\nFile \u001B[0;32m/databricks/spark/python/pyspark/errors/exceptions.py:234\u001B[0m, in \u001B[0;36mcapture_sql_exception.<locals>.deco\u001B[0;34m(*a, **kw)\u001B[0m\n\u001B[1;32m    230\u001B[0m converted \u001B[38;5;241m=\u001B[39m convert_exception(e\u001B[38;5;241m.\u001B[39mjava_exception)\n\u001B[1;32m    231\u001B[0m \u001B[38;5;28;01mif\u001B[39;00m \u001B[38;5;129;01mnot\u001B[39;00m \u001B[38;5;28misinstance\u001B[39m(converted, UnknownException):\n\u001B[1;32m    232\u001B[0m     \u001B[38;5;66;03m# Hide where the exception came from that shows a non-Pythonic\u001B[39;00m\n\u001B[1;32m    233\u001B[0m     \u001B[38;5;66;03m# JVM exception message.\u001B[39;00m\n\u001B[0;32m--> 234\u001B[0m     \u001B[38;5;28;01mraise\u001B[39;00m converted \u001B[38;5;28;01mfrom\u001B[39;00m \u001B[38;5;28mNone\u001B[39m\n\u001B[1;32m    235\u001B[0m \u001B[38;5;28;01melse\u001B[39;00m:\n\u001B[1;32m    236\u001B[0m     \u001B[38;5;28;01mraise\u001B[39;00m\n\n\u001B[0;31mAnalysisException\u001B[0m: Since Spark 2.3, the queries from raw JSON/CSV files are disallowed when the\nreferenced columns only include the internal corrupt record column\n(named _corrupt_record by default). For example:\nspark.read.schema(schema).csv(file).filter($\"_corrupt_record\".isNotNull).count()\nand spark.read.schema(schema).csv(file).select(\"_corrupt_record\").show().\nInstead, you can cache or save the parsed results and then send the same query.\nFor example, val df = spark.read.schema(schema).csv(file).cache() and then\ndf.filter($\"_corrupt_record\".isNotNull).count().","errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":1714545401985,"submitTime":1714545401976,"finishTime":1714545403033,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"059a756f-5812-429e-a15a-61976d28d2c3"},{"version":"CommandV1","origId":2747100633752101,"guid":"7c154f7a-bd18-4544-a339-c0b8be42d30b","subtype":"command","commandType":"auto","position":27.0,"command":"id    name  gender  lang    qual    p_city   P_country   c_city   c_country ","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3b580cba-7555-49c5-854b-08e258212f5a"},{"version":"CommandV1","origId":2747100633752102,"guid":"e58a7408-3b8c-415b-86fa-adb61117e544","subtype":"command","commandType":"auto","position":28.0,"command":"[\n{\n\"id\":\"101\",\n\"name\":\"srinivas\",\n\"gender\":\"male\",\n\"languages\":[\"English\",\"Hindi\"],\n\"qualifcation\":[\"BTech\",\"MTech\"],\n\"address\":{\n\t        \"permanentadress\": {\n\t\t\t\t\t\t\t\t\"city\":\"Hyderabad\",\n\t\t\t\t\t\t\t\t\"country\":\"india\"\n\t\t\t                   },\n\t\t\t\"currentaddress\": {\n\t\t\t\t\t\t\t\t\"city\":\"Guntur\",\n\t\t\t\t\t\t\t\t\"country\":\"india\"\n\t\t\t                   }\n\t\t\t\n          } \n},\n{\n\"id\":\"102\",\n\"name\":\"phani\",\n\"gender\":\"male\",\n\"languages\":[\"English\",\"Hindi\"],\n\"qualifcation\":[\"BTech\",\"MTech\"],\n\"address\":{\n\t        \"permanentadress\": {\n\t\t\t\t\t\t\t\t\"city\":\"Hyderabad\",\n\t\t\t\t\t\t\t\t\"country\":\"india\"\n\t\t\t                   },\n\t\t\t\"currentaddress\": {\n\t\t\t\t\t\t\t\t\"city\":\"Guntur\",\n\t\t\t\t\t\t\t\t\"country\":\"india\"\n\t\t\t                   }\n\t\t\t\n          }\n}\n]\n\n","commandVersion":1,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"errorDetails":null,"baseErrorDetails":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8f60bdd7-431f-4fd9-b186-456bd94971ff"}],"dashboards":[],"guid":"7889f74a-3f84-4c74-97ca-5a2754c75391","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":2747100633752097,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE"}